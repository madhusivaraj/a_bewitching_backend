<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="../static/styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <div class="button-container">
            <div class="button-row">


                                                <!-- WELCOME -->
                <button id ="welcomeButton" onClick="welcome('welcomeButton')" onmousedown="this.style.background='#e21304'"
                onmouseup="this.style.background='#aa2a2a'" type="submit"> BE GRACIOUS: WELCOME YOUR GUESTS</button>
            </div>
        <div class="d-flex flex-row">
            
                                                 <!-- MASK DROP -->
                <div class="button-row">
                    <button id="dropMaskButton" onClick="mask('dropMaskButton')" onmousedown="this.style.background='#e21304'"
                        onmouseup="this.style.background='#aa2a2a'" type="submit">DROP THE MASKS</button> 
                </div>

                                                <!-- TURN ON TV -->
            <div class="button-row">
                    <button id="tvButton" onClick="turn_on_tv('tvButton')" onmousedown="this.style.background='#e21304'"
                    onmouseup="this.style.background='#aa2a2a'" type="submit">TURN ON TV </button>
            </div>

            
                                                 <!-- ILLUMINATE HEADS ON WALL (turns on floodlight) -->
            <div class="button-row">
                    <button id="flashButton" onClick="flash('flashButton')" onmousedown="this.style.background='#e21304'"
                        onmouseup="this.style.background='#aa2a2a'" type="submit">ILLUMINATE MANNEQUIN HEADS</button>
            </div>
                                                    
                                                    <!-- MESS WITH DOLL --> 
            <div class="button-row">
                    <button id="dollButton" onClick="doll('dollButton')" onmousedown="this.style.background='#e21304'"
                        onmouseup="this.style.background='#aa2a2a'" type="submit">TURN THE DOLL HEAD</button>
            </div>
            

        </div>
    </div>

    <script type="text/javascript">
        var maskcount = 1; // zipline
        var welcomecount = 3;
        var flashcount = 3;
        var footstepscount = 3;
        var dollcount = 3;
        var tvcount = 3;
        var list = ["dropMaskButton", "flashButton", "dollButton", "tvButton", "welcomeButton"];

        /* DROPS MASKS */
        function mask(btn) {
            $.ajax({
                type: 'POST',
                url: '/masks'
            });
            
            disableAll(list); // disable all BUT the current button
            var index = list.indexOf("dropMaskButton"); // find index of curr id
            list.splice(index, 1); // remove that id
            setTimeout(setUpAll, 10000, list); // disable all but that one button
            list.push("dropMaskButton");

            maskcount--;
            if (maskcount == 0) {
                disable(btn);
                var index = list.indexOf("dropMaskButton"); // remove from list so itll never be enabled again
                list.splice(index, 1);
                return;
            }
            disable(btn); // disable current button
            setTimeout(setUp, Math.max(2000, 10000), btn); // enable button again
        }

        /* TURNS ON TV */
        function turn_on_tv(btn) {
            $.ajax({
                type: 'POST',
                url: '/turn_on_tv'
            });
            
            disableAll(list); // disable all BUT the current button
            var index = list.indexOf("tvButton"); // find index of curr id
            list.splice(index, 1); // remove that id
            setTimeout(setUpAll, 10000, list); // disable all but that one button
            list.push("tvButton");

            tvcount--;
            if (tvcount == 0) {
                disable(btn);
                var index = list.indexOf("tvButton"); // remove from list so itll never be enabled again
                list.splice(index, 1);
                return;
            }
            disable(btn);
            setTimeout(setUp, Math.max(10000, 2000), btn);
        }

        /* ILLUMINATES MANNEQUIN HEADS (turns on floodlight) */
        function flash(btn) {
            $.ajax({
                type: 'POST',
                url: '/silhouette_event'
            });
            
            disableAll(list); // disable all BUT the current button
            var index = list.indexOf("flashButton"); // find index of curr id
            list.splice(index, 1); // remove that id
            setTimeout(setUpAll, 10000, list); // disable all but that one button
            list.push("flashButton");

            flashcount--;
            if (flashcount == 0) {
                disable(btn);
                var index = list.indexOf("flashButton"); // remove from list so itll never be enabled again
                list.splice(index, 1); // remove that id
                return;
            }
            disable(btn);
            setTimeout(setUp, Math.max(10000, 2000), btn);
        }

        /* MESSES WITH DOLL */
        function doll(btn) {
            $.ajax({
                type: 'POST',
                url: '/doll'
            });
            
            disableAll(list); // disable all BUT the current button
            var index = list.indexOf("dollButton"); // find index of curr id
            list.splice(index, 1); // remove that id
            setTimeout(setUpAll, 10000, list); // disable all but that one button
            list.push("dollButton");

            dollcount--;
            if (dollcount == 0) {
                disable(btn);
                var index = list.indexOf("dollButton"); // remove from list so itll never be enabled again
                list.splice(index, 1); // remove that id
                return;
            }
            disable(btn);
            setTimeout(setUp, Math.max(10000, 2000), btn);
        }

        function setUp(btn) {
            document.getElementById(btn).disabled = false;
            document.getElementById(btn).style.backgroundColor = "#aa2a2a";
        }
        function setUpAll(list) {
            list.forEach(setUp);
        }
        function disableAll(ids) {
            ids.forEach(disable);
        }
        function disable(btn) {
            document.getElementById(btn).disabled = true;
            document.getElementById(btn).style.backgroundColor = "#b1bac9";
        }

    </script>
</body>

</html>
